<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Matthias Kluwe">
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Manual - luacsound</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="..">luacsound</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="..">Home</a>
                            </li>
                            <li class="active">
                                <a href="./">Manual</a>
                            </li>
                            <li >
                                <a href="../license/">License</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="..">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../license/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/mkluwe/luacsound/edit/master/docs/manual.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#manual">Manual</a></li>
            <li><a href="#loading-the-module">Loading the module</a></li>
            <li><a href="#generating-a-new-csound-definition-file">Generating a new Csound definition file</a></li>
            <li><a href="#loading-instruments">Loading instruments</a></li>
            <li><a href="#instrument-files">Instrument files</a></li>
            <li><a href="#using-instruments">Using instruments</a></li>
            <li><a href="#generating-the-output">Generating the output</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="manual">Manual</h1>
<h2 id="loading-the-module">Loading the module</h2>
<p>The module is loaded with <code>require 'luacsound'</code> as usual. This returns a
function that provides the functionality to generate a new Csound definition
file (`.csd) including a new score. By calling this function multiple times,
several scores can be generated "in parallel".</p>
<h2 id="generating-a-new-csound-definition-file">Generating a new Csound definition file</h2>
<p>As said above, call the function provided by the module:</p>
<pre><code class="lua">local csound = require 'luacsound'
local csd = csound()
</code></pre>

<p>Of course, this can be accomplished in one line:</p>
<pre><code class="lua">local csd = require 'luacsound'()
</code></pre>

<p>What you get is an object (called "the Csd-object" here) providing the
functionality to load instruments an outputting the score. Instruments are
loaded by the <code>instr</code> method and can be used to fill the score (see later), the
output is generated by the <code>output</code> method.</p>
<h2 id="loading-instruments">Loading instruments</h2>
<p>Instruments are loaded into the Csd-object by calling the <code>instr</code> method:</p>
<pre><code class="lua">local sine = csd:instr( 'sine' )
</code></pre>

<p>Calling <code>instr</code> loads the definition of the instrument from the <code>.orc</code> file with
the given name, <code>sine.orc</code> in this example (<code>.orc</code> is the extension Csound
traditionally uses for instrument definitions). The method returns a function
that can be used to fill the score of the Csd-object with notes.</p>
<h2 id="instrument-files">Instrument files</h2>
<p>Defining instruments is done one instrument per file, which is quite pratical
for purposes of re-use. Starting the instument block with <code>instr</code> and ending it
with <code>endin</code> is ommitted. Instead of writing</p>
<pre><code>          instr 3                       ; p3=duration of note
k1        linen     p4, p6, p3, p7      ; p4=amp
a1        oscil     k1, p5, 1           ; p5=freq
          out       a1                  ; p6=attack time
          endin                         ; p7=release time
</code></pre>

<p>and documenting the parameters, named parameters are used. Instruments are
numbered automatically when loaded. The example above becomes</p>
<pre><code>k1        linen     $amp, $attack, $dur, $release
a1        oscil     k1, $freq, 1
          out       a1
</code></pre>

<h2 id="using-instruments">Using instruments</h2>
<p>Using loaded instruments is easy. Simply call the associated functions,
providing suitable parameters:</p>
<pre><code class="lua">sine{ freq = 'f6', start = 0, dur = 1, vol = 2 }
sine{ freq = 'f5', start = 1, dur = 1, vol = 2 }
sine{ freq = 'f4', start = 0.5, dur = 1, vol = 2 }
</code></pre>

<p>The function is called with a single argument, a table containing the named
arguments.</p>
<p>The call to an instrument function returns the instrument function itself. Hence
intrument calls can be concatenated:</p>
<pre><code class="lua">sine{ freq = 'f6', start = 0, dur = 1, vol = 2 }
    { freq = 'f5', start = 1, dur = 1, vol = 2 }
    { freq = 'f4', start = 0.5, dur = 1, vol = 2 }
</code></pre>

<h3 id="required-parameters">Required parameters</h3>
<p>The generated score uses the syntax of Csound´s standard numeric score. The
required parameters of each intrument or note statement are the starting time
and the duration time. These are given by the <code>start</code> and the <code>dur</code> entries of
the table the instrument function is called with.</p>
<h3 id="carry-of-function-arguments">Carry of function arguments</h3>
<p>Function arguments are carried from call to call per instrument function to the
effect that you don’t have to repeat this arguments in each call. The following
would create an equivalent score to the example above:</p>
<pre><code class="lua">sine{ freq = 'f6', start = 0, dur = 1, vol = 2 }
    { freq = 'f5', start = 1 }
    { freq = 'f4', start = 0.5 }
</code></pre>

<h3 id="pitch">Pitch</h3>
<p>You can use numbers for frequency parameters, such as <code>freq = 880.2</code>. A
converter from note names to numeric frequencies is built in, using standard
twelve-tone equal temperament tuning. As shown above, the note <code>f5</code> converts to
the frequency of an <em>f</em> above the 440 Hz <em>a</em>, approximately 698.456 Hz. Sharp
and flat notes are specified using <code>#</code> or <code>b</code> as you might expect, for example
<code>f#5</code> or <code>gb5</code>.</p>
<h2 id="generating-the-output">Generating the output</h2>
<p>Output is generated as a string by the <code>output</code> method:</p>
<pre><code class="lua">local output = csd:output()
</code></pre>

<p>You can feed that via standard output directly into the <code>csound</code> command, save
it to a file or do some further processing.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright (c) 2016–2019 Matthias Kluwe</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
